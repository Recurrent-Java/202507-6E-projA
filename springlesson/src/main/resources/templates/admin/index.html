<!-- src/main/resources/templates/admin/index.html -->
<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>【管理者用】HealSweetsEC管理サイト</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
<header>
    <h1>HealSweetsEC管理サイト</h1>
    <form th:action="@{/logout}" method="post">
        <button type="submit" class="header-logout-link">ログアウト</button>
    </form>
</header>

<nav class="global-nav">
    <ul>
        <li><a href="#product-manage">商品追加</a></li>
        <li><a href="#product-list">商品一覧表示・個別削除</a></li>
        <li><a href="#member-delete">会員削除</a></li>
        <li><a href="#member-list">会員一覧表示</a></li>
    </ul>
</nav>

<div class="container">
<main class="content">

<!-- 商品追加 -->
<section id="product-manage" class="content-section">
    <h2>商品追加</h2>
    <form method="post"
          th:action="@{/admin/product/save}"
          th:object="${adminProductForm}"
          enctype="multipart/form-data"
          class="placeholder-form">

        <input type="hidden" th:field="*{productId}"/>

        <!-- エラーメッセージ -->
        <div th:if="${#fields.hasErrors('*')}" style="color:red;margin-bottom:1rem;">
            <ul style="list-style:none;padding:0;">
                <li th:each="err : ${#fields.errors('*')}"
                    th:text="${err}"></li>
            </ul>
        </div>

        <!-- フォーム項目 -->
        <label for="productName">商品名:</label>
        <input type="text" id="productName"
               th:field="*{productName}" placeholder="商品名を入力"><br><br>

        <label for="price">価格:</label>
        <input type="number" id="price"
               th:field="*{price}" min="0" placeholder="0"><br><br>

        <label for="stockQuantity">在庫数:</label>
        <input type="number" id="stockQuantity"
               th:field="*{stockQuantity}" min="0" placeholder="0"><br><br>

        <label for="imageFile">商品画像:</label>
        <input type="file" id="imageFile"
               th:field="*{imageFile}" accept="image/*"><br><br>

        <button type="submit" class="action-button primary-button">
            商品を登録・更新
        </button>
    </form>
</section>

<div class="section-separator"></div>

<!-- 商品一覧 -->
<section id="product-list" class="content-section">
    <h2>商品一覧表示・個別削除</h2>
    <div class="placeholder-table">
        <table>
            <thead>
                <tr>
                    <th>商品ID</th><th>商品名</th><th>価格</th>
                    <th>在庫数</th><th>ステータス</th><th>操作</th>
                </tr>
            </thead>
            <tbody th:if="${productList.isEmpty()}">
                <tr><td colspan="6" style="text-align:center;">商品は登録されていません</td></tr>
            </tbody>
            <tbody th:unless="${productList.isEmpty()}"
                   th:each="product : ${productList}">
                <tr>
                    <td th:text="${product.productId}">P001</td>
                    <td th:text="${product.productName}">サンプルケーキ</td>
                    <td th:text="${product.price + '円'}">1000円</td>
                    <td th:text="${product.stockQuantity}">10</td>
                    <td th:text="${product.saleStatus}">SALE</td>
                    <td>
                        <form method="post" th:action="@{/admin/product/delete}">
                            <input type="hidden" name="productId"
                                   th:value="${product.productId}">
                            <button type="submit"
                                    class="action-button delete-button"
                                    onclick="return confirm('この商品を削除しますか？');">
                                削除
                            </button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</section>

<div class="section-separator"></div>

<!-- 会員削除 -->
<section id="member-delete" class="content-section">
    <h2>会員削除</h2>
    <form method="post"
          th:action="@{/admin/member/delete}"
          th:object="${adminMemberForm}"
          class="placeholder-form">

        <!-- エラー表示（@ModelAttribute で Flash される） -->
        <div th:if="${#fields.hasErrors('memberId')}" style="color:red;margin-bottom:1rem;">
            <p th:errors="*{memberId}"></p>
        </div>

        <label for="delete-id">会員ID:</label>
        <input type="number" id="delete-id"
               th:field="*{memberId}" placeholder="数値を入力 (例: 1)"><br><br>

        <button type="submit" class="action-button delete-button"
                onclick="return confirm('この会員を削除しますか？');">
            会員を削除
        </button>
    </form>
</section>

<div class="section-separator"></div>

<!-- 会員一覧 -->
<section id="member-list" class="content-section">
    <h2>会員一覧表示</h2>
    <div class="placeholder-table">
        <table>
            <thead>
                <tr><th>会員ID</th><th>氏名</th><th>登録日</th><th>メールアドレス</th></tr>
            </thead>
            <tbody th:if="${memberList.isEmpty()}">
                <tr><td colspan="4" style="text-align:center;">会員は登録されていません</td></tr>
            </tbody>
            <tbody th:unless="${memberList.isEmpty()}"
                   th:each="member : ${memberList}">
                <tr>
                    <td th:text="${member.id}">M001</td>
                    <td th:text="${member.name}">山田 太郎</td>
                    <td th:text="${#temporals.format(member.registerDate, 'yyyy/MM/dd')}">2024/01/01</td>
                    <td th:text="${member.email}">test@example.com</td>
                </tr>
            </tbody>
        </table>
    </div>
</section>

</main>
</div>

<footer>
    <p>&copy; 2025 HealSweets EC. All rights reserved.</p>
</footer>
</body>
</html>